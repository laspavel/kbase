global
   nbproc 4
   cpu-map 1 0
   cpu-map 2 1
   cpu-map 3 2
   cpu-map 4 3
   log /dev/log local0
   log /dev/log local1 notice
   chroot /var/lib/haproxy
   stats timeout 30s
   user haproxy
   group haproxy
   daemon
   pidfile /var/run/haproxy.pid
   stats socket /var/run/haproxy.sock mode 777 level admin expose-fd listeners
   stats bind-process 1

defaults
   log global
   mode http
   option dontlognull
   timeout connect 5000
   timeout client 50000
   timeout server 50000

frontend stat-1
   bind *:9001
   mode http
   bind-process 1
   stats enable
   stats uri /haproxy?stats
   stats realm Haproxy\ Statistics
   stats auth howtoforge:howtoforge            #User and Password for login to the monitoring dashboard
   stats admin if TRUE

frontend stat-2
   bind *:9002
   mode http
   bind-process 2
   stats enable
   stats uri /haproxy?stats
   stats realm Haproxy\ Statistics
   stats auth howtoforge:howtoforge            #User and Password for login to the monitoring dashboard
   stats admin if TRUE

frontend stat-3
   bind *:9003
   mode http
   bind-process 3
   stats enable
   stats uri /haproxy?stats
   stats realm Haproxy\ Statistics
   stats auth howtoforge:howtoforge            #User and Password for login to the monitoring dashboard
   stats admin if TRUE

frontend stat-4
   bind *:9004
   mode http
   bind-process 4
   stats enable
   stats uri /haproxy?stats
   stats realm Haproxy\ Statistics
   stats auth howtoforge:howtoforge            #User and Password for login to the monitoring dashboard
   stats admin if TRUE

frontend http_front
   bind *:80
   mode http
   option forwardfor       except 127.0.0.0/8
   default_backend http_back

backend http_back
   balance roundrobin
   mode http
   server shop-node-d01 10.0.9.24:80
   server shop-node-d02 10.0.9.25:80
   server shop-node-d03 10.0.9.26:80
   server shop-node-d04 10.0.9.51:80

frontend http_front433
   bind *:443
   mode tcp
   default_backend http_back443

backend http_back443
   balance roundrobin
   mode tcp
   option ssl-hello-chk
   option log-health-checks
   server shop-node-d01 10.0.9.24:443 check
   server shop-node-d02 10.0.9.25:443 check
   server shop-node-d03 10.0.9.26:443 check
   server shop-node-d04 10.0.9.51:443 check

